// I used a template script from somewhere, cannot recall from where! So apologies if I did not 
client = new Paho.MQTT.Client("m14.cloudmqtt.com", 33337,"web_" + parseInt(Math.random() * 100));
client.onConnectionLost = onConnectionLost;
client.onMessageArrived = onMessageArrived;


	var x, y;
	var dx, dy;


  var options = {
    useSSL: true,
    userName: "yyqzwwpb",
    password: "UHDKx2H5Jmp_",
    onSuccess:onConnect,
    onFailure:doFail
  }

  // connect the client
  client.connect(options);

  // called when the client connects
  function onConnect() {
    // Once a connection has been made, make a subscription and send a message.
    console.log("onConnect");
    text("MQTT connected", 20, 40);
    
    client.subscribe("braamcharldr");
    message = new Paho.MQTT.Message("Hi");
    message.destinationName = "braambeeraaa";
    client.send(message);
  }

  function doFail(e){
    console.log(e);
  }

let JohnButton;

function John() {
  
  message = new Paho.MQTT.Message("John");
  message.destinationName = "braambeeraaa";
  client.send(message);
}

function trick3() {
  message = new Paho.MQTT.Message("trick3");
  message.destinationName = "braambeeraaa";
  
client.send(message);
}

function trick2() {
  message = new Paho.MQTT.Message("trick2");
  message.destinationName = "braambeeraaa";
  
  client.send(message);
}

function trick1() {
  message = new Paho.MQTT.Message("trick1");
  message.destinationName = "braambeeraaa";
  
  client.send(message);
}


	function setup()
	{
		// graphics stuff:
		createCanvas(800, 600);
  JohnButton = createButton('trick2');
  JohnButton.position(1, 20);
  JohnButton.mousePressed(trick2);
    
      PeterButton = createButton('trick3');
  PeterButton.position(1, 40);
  PeterButton.mousePressed(trick3);
    

   
  SallyButton = createButton('trick1');
  SallyButton.position(1, 1);
  SallyButton.mousePressed(trick1);
    
		background(255, 255, 255);
		fill(0, 0, 0, 255);
		x = width/2;
		y = height/2;
		dx = 0;
		dy = 0;

		// instructions:
		textSize(20);
		textAlign(LEFT);
		text("draw: up (or grow), down, left, right, clear", 20, 20);

	}

	function draw()
	{
		ellipse(x, y, 5, 5);
		x+=dx;
		y+=dy;
		if(x<0) x = width;
		if(y<0) y = height;
		if(x>width) x = 0;
		if(y>height) y = 0;
	}

  


  // called when the client loses its connection
  function onConnectionLost(responseObject) {
    if (responseObject.errorCode !== 0) {
      console.log("onConnectionLost:"+responseObject.errorMessage);
      text("MQTT connection lost", 20, 40);
    }
  }

  // called when a message arrives
  function onMessageArrived(message) {
    console.log("onMessageArrived:"+message.payloadString);
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = "#FF0000";
    ctx.fillRect(0, 0, message.payloadString, 75)
    
    //background(100);
    //ellipse(50, message.payloadString, 100,100);
    
  }
